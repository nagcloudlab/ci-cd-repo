cd /path/to/ci-cd-repo

# Create the corrected workflow
cat > .github/workflows/simple-ci.yml << 'EOF'
name: Simple CI - Build and Push

on:
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  id-token: write
  contents: read

env:
  JAVA_VERSION: '17'
  AWS_REGION: ap-south-1
  AZURE_REGION: centralindia

jobs:
  build-and-push:
    name: Build & Push to Both Clouds
    runs-on: ubuntu-latest
    
    steps:
      # ============================================
      # 1. CHECKOUT CODE
      # ============================================
      - name: ðŸ“¥ Checkout Code
        uses: actions/checkout@v4
      
      # ============================================
      # 2. SETUP JAVA
      # ============================================
      - name: â˜• Setup Java
        uses: actions/setup-java@v4
        with:
          java-version: ${{ env.JAVA_VERSION }}
          distribution: 'temurin'
          cache: 'maven'
      
      # ============================================
      # 3. BUILD WITH MAVEN (in transfer-service/)
      # ============================================
      - name: ðŸ”¨ Build with Maven
        run: |
          echo "Building Spring Boot application..."
          cd transfer-service
          ./mvnw clean package -DskipTests -B
          echo "âœ… Build complete!"
          ls -lh target/*.jar
      
      # ============================================
      # 4. BUILD DOCKER IMAGE
      # ============================================
      - name: ðŸ³ Build Docker Image
        run: |
          echo "Building Docker image..."
          docker build -t transfer-service:${{ github.sha }} .
          docker tag transfer-service:${{ github.sha }} transfer-service:latest
          echo "âœ… Docker image built!"
          docker images | grep transfer-service
      
      # ============================================
      # 5. PUSH TO AWS ECR
      # ============================================
      - name: ðŸ” Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v4
        with:
          role-to-assume: ${{ secrets.AWS_ROLE_ARN }}
          aws-region: ${{ env.AWS_REGION }}
      
      - name: ðŸ”‘ Login to Amazon ECR
        id: login-ecr
        uses: aws-actions/amazon-ecr-login@v2
      
      - name: ðŸ“¤ Push to AWS ECR
        env:
          ECR_REGISTRY: ${{ steps.login-ecr.outputs.registry }}
        run: |
          # Create ECR repository if it doesn't exist
          aws ecr describe-repositories --repository-names transfer-service 2>/dev/null || \
            aws ecr create-repository --repository-name transfer-service
          
          # Tag and push
          docker tag transfer-service:latest $ECR_REGISTRY/transfer-service:${{ github.sha }}
          docker tag transfer-service:latest $ECR_REGISTRY/transfer-service:latest
          
          docker push $ECR_REGISTRY/transfer-service:${{ github.sha }}
          docker push $ECR_REGISTRY/transfer-service:latest
          
          echo "âœ… Pushed to AWS ECR!"
          echo "Image: $ECR_REGISTRY/transfer-service:latest"
      
      # ============================================
      # 6. PUSH TO AZURE ACR
      # ============================================
      - name: ðŸ” Azure Login
        uses: azure/login@v1
        with:
          client-id: ${{ secrets.AZURE_CLIENT_ID }}
          tenant-id: ${{ secrets.AZURE_TENANT_ID }}
          subscription-id: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
      
      - name: ðŸ“¤ Push to Azure ACR
        run: |
          # Create ACR if it doesn't exist
          ACR_NAME="transferserviceacr"
          
          # Try to create resource group (might exist)
          az group create --name transfer-rg --location centralindia 2>/dev/null || echo "Resource group exists"
          
          # Try to create ACR (might exist)
          az acr create --resource-group transfer-rg --name $ACR_NAME --sku Basic 2>/dev/null || echo "ACR exists"
          
          # Login to ACR
          az acr login --name $ACR_NAME
          
          # Get ACR login server
          ACR_SERVER=$(az acr show --name $ACR_NAME --query loginServer -o tsv)
          
          # Tag and push
          docker tag transfer-service:latest $ACR_SERVER/transfer-service:${{ github.sha }}
          docker tag transfer-service:latest $ACR_SERVER/transfer-service:latest
          
          docker push $ACR_SERVER/transfer-service:${{ github.sha }}
          docker push $ACR_SERVER/transfer-service:latest
          
          echo "âœ… Pushed to Azure ACR!"
          echo "Image: $ACR_SERVER/transfer-service:latest"
      
      # ============================================
      # 7. SUMMARY
      # ============================================
      - name: ðŸ“Š Summary
        run: |
          echo "### ðŸŽ‰ Build & Push Complete!" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **Maven Build**: Success" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **Docker Build**: Success" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **AWS ECR**: Pushed" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **Azure ACR**: Pushed" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Commit**: ${{ github.sha }}" >> $GITHUB_STEP_SUMMARY

